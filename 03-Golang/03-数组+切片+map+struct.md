#Go #Golang 

# 1.  æ•°ç»„
æ•°ç»„æ˜¯ä¸€ä¸ªå›ºå®šé•¿åº¦ç‰¹å®šçš„ç±»å‹å…ƒç´ ç»„æˆçš„åºåˆ—ï¼Œå®ƒçš„é•¿åº¦å›ºå®šï¼Œè¿™ä¸ªè·ŸJavaæœ‰ç‚¹åƒï¼Œä¸€èˆ¬ä¸ç”¨æ•°ç»„ï¼Œç”¨çš„æœ€å¤šçš„å…¶å®æ˜¯ArrayListï¼Œ goä¹Ÿæœ‰å¯¹åº”çš„ï¼Œå«`Slice`ï¼Œç¿»è¯‘ä¸­æ–‡å« ã€åˆ‡ç‰‡ã€ å¾ˆæ€ªğŸ˜±ğŸ˜±

## 1.1 å®šä¹‰å’Œåˆå§‹åŒ–æ•°ç»„

```go
var arr [3]int  // å¤§å°ä¸º3çš„æ•°ç»„
arr := [3]int{}   // å’Œä¸Šé¢ä¸€æ ·
// å£°æ˜çš„æ—¶å€™ï¼Œç›´æ¥èµ‹å€¼
arr := [3]int{1,3,4} 
arr := [3]int{1,4}  // ä¹Ÿå¯ä»¥åˆå§‹åŒ–éƒ¨åˆ†ï¼Œåé¢çš„éƒ½æ˜¯ä¸º0

// å¦‚æœæ•°ç»„çš„é•¿åº¦ä½ç½®å‡ºç°...çœç•¥å·ï¼Œè¡¨ç¤ºæ•°ç»„çš„é•¿åº¦ç”±åˆå§‹åŒ–çš„å€¼çš„ä¸ªæ•°æ¥è®¡ç®—
arr := [...]int{1,2,3}  // æœ€åå¤§å°å°±æ˜¯3
// æ•°ç»„çš„é•¿åº¦æ˜¯æ•°ç»„ç±»å‹çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥[3]intå’Œ[4]intæ˜¯ä¸åŒçš„æ•°ç»„ç±»å‹
q := [3]int{1,2,3}
q = [4]int{4,5,6,7}  // âŒ âŒ âŒ è¿™ä¸ªæ˜¯é”™è¯¯çš„

// è¿˜æœ‰ä¸€ä¸ªå¾ˆå¥‡è‘©çš„åˆå§‹åŒ–æ–¹å¼
arr := [...]int{0:1,1:6,2:8} // åœ¨åˆå§‹åŒ–ä¸­é€šè¿‡ç±»ä¼¼k:vçš„æ–¹å¼ï¼Œæ¥æŒ‡å®šindexä¸‹çš„æ•°æ® æœ€ç»ˆæ•°ç»„æ˜¯[1,6,8]
arr := [...]int{99: 1}  // å¯ä»¥åˆå§‹åŒ–ä¸€ä¸ªå¤§å°ä¸º100çš„æ•°ç»„ï¼Œindex=99çš„å€¼ä¸º1ï¼Œå…¶ä½™ä¸º0
```

# 2. Slice åˆ‡ç‰‡

åˆ‡ç‰‡Sliceä»£è¡¨çš„æ˜¯å˜é•¿çš„åºåˆ—ï¼Œåºåˆ—ä¸­æ¯ä¸ªå…ƒç´ å¿…é¡»ç›¸åŒç±»å‹ã€‚ä¸€ä¸ªsliceç±»å‹ä¸€èˆ¬å†™ä½œ`[]T` ï¼Œå…¶ä¸­Tä»£è¡¨sliceä¸­çš„å…ƒ  ç´ ç±»å‹ï¼Œsliceçš„è¯­æ³•å’Œæ•°ç»„å¾ˆåƒï¼Œåªæ˜¯æ²¡æœ‰å›ºå®šé•¿åº¦
åˆ‡ç‰‡å¯ä»¥ä»æ•°ç»„æˆ–è€…å¦ä¸€ä¸ªsliceè€Œæ¥ï¼Œä½†æ›´å¸¸è§çš„æ˜¯ç›´æ¥åˆ›å»ºä¸€ä¸ªåˆ‡ç‰‡ï¼Œè¿™ä¸ªåº•å±‚æ˜¯åˆ›å»ºäº†ä¸€ä¸ªåŒ¿åæ•°ç»„

ä¸€ä¸ªsliceæœ‰ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ ï¼š**æŒ‡é’ˆã€é•¿åº¦ä»¥åŠå®¹é‡**
å¤§è‡´ç±»ä¼¼è¿™ä¸ªç»“æ„
```go
type IntSlice struct {
ptr *int
len, cap int
}
```

## 2.1 ä»æ•°ç»„æ´¾ç”Ÿå‡ºslice

![[Pasted image 20250908153456.png]]

```go
arr := [8]string{"a","b","c","d","e","f","g","h"}
slice := arr[1:4]   // è¿™ä¸ªé•¿åº¦å°±æ˜¯ 4-1 = 3ï¼Œ å®¹é‡å°±æ˜¯ä»1 åˆ° len(arr-1) å®¹é‡7
endless := slice[:6]  // è¿™æ²¡æœ‰é—®é¢˜ï¼Œè¿”å›çš„å°±æ˜¯ åˆ‡ç‰‡ [a, b, c, d ,e, f]  // å› ä¸ºæ²¡æœ‰è¶…è¿‡å®¹é‡
endless := slice[:8] //âŒ âŒ panic: runtime error: slice bounds out of range [:5] with capacity 4
```


>[!danger]
> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œsliceå”¯ä¸€åˆæ³•çš„æ¯”è¾ƒæ“ä½œæ˜¯å’Œ`nil`è¿›è¡Œæ¯”è¾ƒï¼Œå…¶ä»–çš„æ¯”è¾ƒéƒ½æ˜¯éæ³•çš„ï¼Œä¸¤ä¸ªsliceä¹‹é—´éƒ½ä¸èƒ½ç›´æ¥`!=`è¿™ç§æ¯”è¾ƒ

## 2.2 é€šè¿‡makeåˆ›å»º

å†…ç½®çš„å‡½æ•°`make`å¯ä»¥åˆ›å»ºä¸€ä¸ªæŒ‡å®šå…ƒç´ ç±»å‹ã€é•¿åº¦å’Œå®¹é‡çš„sliceã€‚ å…¶ä¸­å®¹é‡éƒ¨åˆ†å¯ä»¥çœç•¥ï¼Œçœç•¥çš„è¯ï¼Œå°±æ˜¯å®¹é‡=é•¿åº¦

```go
s := make([]int, 5) // å®¹é‡ä¸º5
s := make([]int, 5, 20)  // å®¹é‡ä¸º20
```

åº•å±‚åŸç†æ˜¯åˆ›å»ºäº†ä¸€ä¸ªåŒ¿åçš„æ•°ç»„å˜é‡ï¼Œç„¶åè¿”å›sliceï¼›åªæœ‰é€šè¿‡è¿”å›çš„sliceæ‰èƒ½å¼•ç”¨åº•å±‚åŒ¿åçš„æ•°ç»„å˜é‡ã€‚
ç¬¬ä¸€ä¸ªè¯­å¥ï¼Œç›¸å½“äºsliceå°±æ˜¯æ•´ä¸ªå¤§å°ä¸º5çš„æ•°ç»„çš„å®Œå…¨å‰¯æœ¬ã€‚
ç¬¬äºŒä¸ªè¯­å¥ï¼Œç›¸å½“äºåªå¼•ç”¨äº†å‰5ä¸ªå…ƒç´ ï¼Œä½†æ˜¯å®¹é‡æ˜¯åŒ…å«æ•´ä¸ªå¤§å°ä¸º20çš„æ•°ç»„çš„

## 2.3 é€šè¿‡å­—é¢é‡çš„æ–¹å¼

æ³¨æ„æ˜¯ `[]T{}`çš„æ–¹å¼

```go
// æœ€å¸¸è§çš„æ–¹å¼æ˜¯
s := []int{3,4,5} 
var s []int  // è¿™ç§ç›¸å¯¹åˆ›å»ºäº†ç©ºçš„sliceï¼Œlen=0, capä¹Ÿç­‰äº0
```

## 2.4 sliceçš„ä¸€äº›ç”¨æ³•

1. appendå‡½æ•°
å†…ç½®çš„appendå‡½æ•°ç”¨äºå‘sliceè¿½åŠ å…ƒç´ ï¼Œ å¹¶è¿”å›ä¸€ä¸ªsliceï¼Œè¿™ä¸ªsliceå’ŒåŸæ¥çš„sliceæ˜¯å…¬ç”¨åŒä¸€ä¸ªåº•å±‚æ•°ç»„ï¼ŒåŒºåˆ«äºæ˜¯å¦æ‰©å®¹å’Œå¤åˆ¶æ•°ç»„ã€‚è¿™ä¸€ç‚¹å’ŒJavaä¸­çš„ArrayListæœ‰ç‚¹ç±»ä¼¼ã€‚

```go
s = append(s, 10, 20) // è¿½åŠ ä¸¤ä¸ªæ•°æ®
// åˆ é™¤ç´¢å¼•ä¸º1çš„å…ƒç´ 
s2 = append(s2[:1], s2[2:]...)
```

> [!danger]
> ä¸Šé¢çš„`s2[2:]...`  è¿™ä¸ªå†™æ³•å°±è·ŸJavaScriptä¸­çš„`...`ä¸€æ ·ï¼Œè§£æ„sliceï¼Œå°†sliceæ•°æ®ï¼Œç›´æ¥å…¨éƒ¨è§£æ„å‡ºæ¥

åº•å±‚çš„åŸç†ï¼š
- å¦‚æœæ·»åŠ åçš„é•¿åº¦å°äºç­‰äºcapacityï¼Œé‚£ä¹ˆå°±ç›´æ¥èµ‹å€¼å°±è¡Œ
- ä½†æ˜¯å¤§äºcapacityäº†ï¼Œå°±è¦è¿›è¡Œæ‰©å®¹ä¸€å€ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„sliceï¼Œå°†åŸæœ‰çš„æ•°æ®copyè¿‡å»ï¼Œå°±OKäº†

2.  åˆ é™¤å…ƒç´ 

æœ‰ä¸¤ç§æ–¹å¼
1. å»é™¤ä¸¤ä¸ªéƒ¨åˆ†ï¼Œç„¶åæ‹¼æ¥èµ·æ¥

```go
s = append(s[:1], s[2:]...)  // è¿™ä¸ªå°±æ˜¯ä¸¤æ®µæ‹¼èµ·æ¥
```

2.  å°†ååŠéƒ¨åˆ†ï¼Œå¤åˆ¶åˆ°æ­£ç¡®çš„ä½ç½®ï¼Œç„¶åæˆªå–

```go
func delete(s []int, index int) []int {
	copy(s[index:], s[index+1:])
	return s[:len(s) - 1]
}
```

## 2.5 å…³äºsliceçš„ä¸€äº›æŠ€å·§

1. é¢„åˆ†é…å®¹é‡ï¼Œæé«˜æ€§èƒ½
	1. è¿™ä¸ªå’ŒJavaç±»ä¼¼ï¼Œå¦‚æœæ˜ç¡®çš„çŸ¥é“å¤§è‡´éœ€è¦å¤šå°‘å®¹é‡ï¼Œå¯ä»¥é¢„åˆ†é…å¤§ä¸€ç‚¹çš„å®¹é‡ï¼Œè¿™æ ·å¯ä»¥å‡å°‘é¢‘ç¹çš„åˆ†é…å†…å­˜å’Œå¤åˆ¶æ•°æ®ï¼Œä»è€Œå¤§å¹…æé«˜æ€§èƒ½
2. å·§ç”¨`copy`å‡½æ•°
	1. `copy()`å‡½æ•°å¯ä»¥å°†ä¸€ä¸ªåˆ‡ç‰‡çš„å…ƒç´ å¤åˆ¶åˆ°å¦ä¸€ä¸ªåˆ‡ç‰‡ï¼Œè¿™æ¯”æ‰‹åŠ¨å¾ªç¯èµ‹å€¼è¦é«˜æ•ˆ

```go
source := []int{1, 2, 3}
destination := make([]int, 3)
copy(destination, source) // å°† source çš„å†…å®¹å¤åˆ¶åˆ° destination
```

3. æ¸…ç©ºåˆ‡ç‰‡

æ¸…ç©ºåˆ‡ç‰‡æœ€å¿«çš„æ–¹å¼æ˜¯å°†å…¶é•¿åº¦è®¾ä¸º0ï¼Œä»è€Œæ— éœ€é‡æ–°åˆ†é…å†…å­˜

```go
mySlice := []int{1, 2, 3}
mySlice = mySlice[:0] // é•¿åº¦å˜ä¸º0ï¼Œå®¹é‡ä¸å˜
```

4. é¿å…åˆ‡ç‰‡æ³„éœ²

å½“ä»ä¸€ä¸ªå¤§åˆ‡ç‰‡æˆªå–å°åˆ‡ç‰‡ä¹‹åï¼Œç„¶åå¤§åˆ‡ç‰‡ä¸å†ä½¿ç”¨ï¼Œå°åˆ‡ç‰‡ä¾ç„¶æŒæœ‰å¯¹åº•å±‚å¤§å”ç»„çš„å¼•ç”¨ï¼Œå¯¼è‡´æ— æ³•GCï¼Œå¯èƒ½æœ‰å†…å­˜æ³„éœ²é—®é¢˜
å¯ä»¥ä½¿ç”¨`copy`å‡½æ•°å°†å°åˆ‡ç‰‡çš„å†…å®¹å¤åˆ¶åˆ°ä¸€ä¸ªæ–°çš„ã€å°çš„åº•å±‚æ•°ç»„ä¸­

```go
// å‡è®¾ bigSlice éå¸¸å¤§ï¼Œä½†æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªå°å­é›†
bigSlice := make([]byte, 10000)
smallSlice := bigSlice[100:200]
// åˆ›å»ºä¸€ä¸ªæ–°åˆ‡ç‰‡ï¼ŒåªåŒ…å« smallSlice çš„å†…å®¹
// è¿™æ · bigSlice å°±å¯ä»¥è¢«åƒåœ¾å›æ”¶äº†
newSlice := make([]byte, len(smallSlice))
copy(newSlice, smallSlice)
```

# 3. Map 

è¿™ä¸ªmapä½¿ç”¨å’ŒJavaä¸Šçš„ä½¿ç”¨å‡ ä¹æ²¡æœ‰åŒºåˆ«ï¼Œæœ‰çš„åªæœ‰ä¸€äº›ç»†èŠ‚ä¸Šçš„ä¸åŒè€Œå·²

## 3.1 å£°æ˜å’Œåˆå§‹åŒ–

goä¸­çš„Mapåˆå§‹åŒ–æœ‰ä¸¤ç§æ–¹å¼
1. é€šè¿‡`make`å‡½æ•°è¿›è¡Œåˆ›å»º
	1. è¯­æ³•ï¼š `make(map[é”®ç±»å‹]å€¼ç±»å‹`
2. é€šè¿‡å­—é¢é‡çš„æ–¹å¼åˆ›å»º
	1. `map[é”®ç±»å‹]å€¼ç±»å‹{é”®1: å€¼1, é”®2: å€¼2, ...}`

```go
m := make(map[int]int)
m[23] = 100
// å­—é¢é‡çš„æ–¹å¼
a := map[string]int{
		"name": 223,
		"age":  22,
	}
```

## 3.2 è®¿é—®å…ƒç´ 

æ­£å¸¸æƒ…å†µä¸‹ï¼Œç›´æ¥é€šè¿‡`map[k]`çš„æ–¹å¼å°±èƒ½è·å–åˆ°å€¼ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªç‰¹åˆ«æ³¨æ„çš„å‘ï¼Œå¦‚æœå€¼æ˜¯intç±»å‹çš„ï¼Œ å–å€¼ä¸€ä¸ªä¸å­˜åœ¨çš„keyï¼Œé‚£ä¹ˆä¼šè¿”å›0ï¼Œè¿™ä¸ªè·ŸJavaä¸åŒï¼ŒJavaæ˜¯è¿”å›ä¸€ä¸ªnullï¼Œ goæ˜¯è¿”å›é›¶å€¼ï¼Œè¿™å°±æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¯¼è‡´æ°å·§å€¼æ˜¯0 ï¼Œè¿˜æ˜¯å› ä¸ºkeyä¸å­˜åœ¨è€Œè¿”å›çš„0ï¼Ÿ

æ‰€ä»¥ï¼Œgoæä¾›äº†ä¸€ç§æ›´åŠ å®‰å…¨çš„å¤„ç†æ–¹å¼ `v,ok := map[k]` çš„æ–¹å¼ï¼Œå®ƒä¼šè¿”å›ä¸¤ä¸ªå€¼ï¼Œå…¶ä¸­okå°±æ˜¯åˆ¤æ–­å€¼æ˜¯å¦å­˜åœ¨çš„

```go
scores := map[string]int{"Alice": 98, "Bob": 88}

// å®‰å…¨åœ°è·å–å€¼
value, ok := scores["Alice"]   // âœ… âœ… âœ…
if ok {
	fmt.Println("Alice çš„åˆ†æ•°æ˜¯:", value)
} else {
	fmt.Println("Alice ä¸åœ¨ map ä¸­")
}

// è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„é”®ä¼šè¿”å›é›¶å€¼ï¼ˆæœ¬ä¾‹ä¸­ä¸º 0ï¼‰
value2, ok2 := scores["Charlie"]
fmt.Println("Charlie çš„åˆ†æ•°æ˜¯:", value2) // è¾“å‡º: 0
fmt.Println("Charlie æ˜¯å¦å­˜åœ¨:", ok2)   // è¾“å‡º: false
```

## 3.3 åˆ é™¤å…ƒç´ 

é€šè¿‡å†…ç½®çš„å‡½æ•°`delete`æ¥è§£å†³

```go
scores := map[string]int{"Alice": 98, "Bob": 88}

delete(scores, "Bob") // åˆ é™¤é”® "Bob"
fmt.Println(scores)   // è¾“å‡º: map[Alice:98]
```

## 3.4 éå†å…ƒç´ 


```go
colors := map[string]string{
	"red":   "#ff0000",
	"green": "#00ff00",
	"blue":  "#0000ff",
}

for key, value := range colors {
	fmt.Printf("é”®: %s, å€¼: %s\n", key, value)
}
```

## 3.5 nilçš„å¤„ç†
mapçš„é›¶å€¼æ˜¯`nil`ï¼Œ é‚£ä¹ˆä¸èƒ½ç›´æ¥è®¿é—®å’Œæ·»åŠ å…ƒç´ ï¼Œåªèƒ½=ç›´æ¥èµ‹å€¼ï¼Œæ‰€ä»¥æ˜¾å¾—é¸¡è‚‹ï¼Œå¤§å®¶éƒ½æ˜¯ç›´æ¥åˆå§‹åŒ–å°±ç”¨äº†

```go
var myMap map[string]int // myMap çš„é›¶å€¼æ˜¯ nil

// è¿™è¡Œä»£ç ä¼šå¼•å‘ panic
// myMap["test"] = 1 

// æ­£ç¡®çš„åšæ³•æ˜¯å…ˆç”¨ make() åˆå§‹åŒ–
myMap = make(map[string]int)
myMap["test"] = 1
```

# 4. struct è‡ªå®šä¹‰ç»“æ„ä½“

goä¸­æ²¡æœ‰Javaä¸­çš„ç±»çš„æ¦‚å¿µï¼Œæ‰€ä»¥åªèƒ½ç”¨`struct`æ¥ä»£æ›¿ï¼Œ è·ŸCè¯­è¨€å¾ˆåƒ

```go
type Person struct {
	Name         string    // æ³¨æ„ï¼Œæ²¡æœ‰å†’å· ï¼ŒåŒæ ·ç»“å°¾æ²¡æœ‰é€—å·æˆ–è€…åˆ†å·
	Age          uint8
	Tel, Address string   // ç›¸åŒç±»å‹çš„å¯ä»¥ä¸€èµ·å£°æ˜
} 
```

> [!danger]
> æ³¨æ„ï¼Œæ¯è¡Œæœ€åæ²¡æœ‰åˆ†å·ï¼Œå±æ€§å’Œç±»å‹ä¹‹é—´ä¹Ÿæ²¡æœ‰å†’å·ï¼› ç›¸åŒç±»å‹çš„å¯ä»¥ä¸€èµ·å£°æ˜

## 4.1 åˆå§‹åŒ–

```go
// æ–¹å¼1ï¼š æŒ‰ç…§å­—æ®µé¡ºåºåˆå§‹åŒ–ï¼Œä¸æ¨è
var p = Person{"zmg", 22, "12323", "Shanghai"}  // ç›¸å½“äºä¸€ä¸€å¯¹åº”ï¼Œè¿™ç§æ–¹å¼ä¸å¥½ï¼Œåªé€‚åˆå±æ€§å¾ˆå°‘çš„
// æ–¹å¼2ï¼š é€šè¿‡kvæ–¹å¼åˆå§‹åŒ–ï¼Œæœ€æ¨è
p := Person{Name: "zmg", Age: 22}  //é€šè¿‡è¿™ä¸ªk-vçš„æ–¹å¼ï¼Œæ‰æ˜¯æ­£ç¡®çš„
// æ–¹å¼3ï¼šé›¶å€¼åˆå§‹åŒ–ï¼Œåç»­åœ¨è¿›è¡Œèµ‹å€¼æ“ä½œ
var p Person    // é›¶å€¼åˆå§‹åŒ–
```

> [!danger]
> æ³¨æ„ï¼Œä¸€ä¸ªPç±»å‹ä¸­çš„ä¸èƒ½åŒ…å«å±æ€§ä¸ºPç±»å‹çš„ï¼Œ åªèƒ½ç”¨Pç±»å‹çš„æŒ‡é’ˆï¼Œå½“ç„¶å¯ä»¥åŒ…å«å…¶ä»–ç±»å‹ï¼Œè¿™ä¸ªå°±æ˜¯ç»„åˆçš„å½¢å¼ï¼Œç±»ä¼¼Javaä¸­çš„ç»§æ‰¿

```go
type Person struct {
	Name         string
	Age          uint8
	Tel, Address string
	Superior     *Person    // åŒ…å«ä¸€ä¸ªPersonç±»å‹çš„æŒ‡é’ˆ
}
```

## 4.2 ç»“æ„ä½“æ¯”è¾ƒ

å¦‚æœç»“æ„ä½“ä¸­çš„å±æ€§éƒ½æ˜¯å¯æ¯”è¾ƒçš„ï¼Œé‚£ä¹ˆè¿™ä¸ªç»“æ„ä½“å°±æ˜¯å¯æ¯”è¾ƒçš„
å¯æ¯”è¾ƒçš„ç»“æ„ä½“ï¼Œå¯ä»¥ä½œä¸ºmapçš„keyæ¥ä½¿ç”¨ï¼›è¦ä¸ç„¶ä¸èƒ½ä½œä¸ºkeyæ¥ä½¿ç”¨

## 4.3 è®¿é—®å­—æ®µ

å’ŒJavaçš„è®¿é—®ä¸€æ ·ï¼Œé€šè¿‡`.`è¿›è¡Œè®¿é—®å’Œä¿®æ”¹ç»“æ„çš„å­—æ®µ

```go
user := User{Name: "Charlie", Age: 40}
fmt.Println(user.Name) // è¾“å‡º: Charlie

user.Age = 41          // ä¿®æ”¹å­—æ®µå€¼
fmt.Println(user.Age)  // è¾“å‡º: 41
```

## 4.4 ä½¿ç”¨ç»“æ„ä½“æŒ‡é’ˆ

æ­£å¸¸æƒ…å†µä¸‹ï¼Œåœ¨æ–¹æ³•çš„å‚æ•°ä¸­éƒ½æ˜¯æ¥æ”¶ç»“æ„ä½“æŒ‡é’ˆï¼Œé¿å…åœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™å¯¹æ•´ä¸ªç»“æ„ä½“è¿›è¡Œå€¼æ‹·è´ï¼Œä»è€Œæå‡æ€§èƒ½

```go
func increaseAge(u *User) {
    (*u).Age++ // ä¸¤ç§è¯­æ³•éƒ½å¯ä»¥
    u.Age++    // æ›´ç®€æ´çš„è¯­æ³•ï¼ŒGoä¼šè‡ªåŠ¨è§£å¼•ç”¨
}

func main() {
    user := User{Name: "David", Age: 35}
    increaseAge(&user) // ä¼ é€’ç»“æ„ä½“çš„åœ°å€
    fmt.Println(user.Age) // è¾“å‡º: 36
}
```

## 4.5 åµŒå¥—ç»“æ„ä½“å’ŒåŒ¿åæˆå‘˜

èƒŒæ™¯ï¼š æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä¸¤ä¸ªç»“æ„ä½“ï¼ŒåŒ…å«åˆ«äººåº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ

```go
type A struct {
	Name string
}

type B stuct {
	Age int8
	Ainfo A
}

// ç„¶åæ€ä¹ˆè®¿é—®Ainfoä¸­çš„Nameå‘¢ï¼Ÿ
var b B
b.Ainfo.Name = "zmg"  // â—ï¸ â—ï¸ â—ï¸è¿™æ ·å°±æ˜¾å¾—æœ‰ç‚¹å•°å—¦ï¼Œä¸å¤Ÿç®€æ´
```

æ‰€ä»¥ï¼Œgoæä¾›äº†ä¸€ä¸ªç‰¹æ€§è®©æˆ‘ä»¬åªå£°æ˜ä¸€ä¸ªæˆå‘˜å¯¹åº”çš„æ•°æ®ç±»å‹è€Œä¸æŒ‡å®šæˆå‘˜çš„åç§°ï¼š è¿™ä¸ªå°±æ˜¯åŒ¿åæˆå‘˜
- åŒ¿åæˆå‘˜çš„æ•°æ®ç±»å‹å¿…é¡»æ˜¯ä¸€ä¸ªå‘½åçš„ç±»å‹æˆ–è€…æŒ‡å‘ä¸€ä¸ªå‘½ä»¤çš„ç±»å‹çš„æŒ‡é’ˆ
- è¿™ä¸ªå…¶å®å°±æ˜¯Goæä¾›çš„ç»§æ‰¿çš„é€»è¾‘ï¼Œåœ¨goä¸­æˆä¸º`Composition - ç»„åˆ`ï¼Œè¿™æ˜¯Goå®ç°é¢å‘å¯¹è±¡è®¾è®¡çš„ä¸»è¦æ–¹å¼

```go
// ä¸Šé¢çš„å°±å¯ä»¥å†™æˆ
type A struct {
	Name string
}

type B stuct {
	Age int8
	A
}
// ä½¿ç”¨çš„æ—¶å€™ç›´æ¥ç”¨
var b B
b.Name = "zmg"
// å½“ç„¶ä¹‹å‰çš„æ–¹å¼ä¹Ÿå¯ä»¥
b.A.Name = "zmg" //  è¿™ä¸ªæ–¹å¼ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯æ›´å¤šçš„æ˜¯ä½¿ç”¨ä¸Šé¢çš„å†™æ³•
```

<span class="r">å€¼å¾—æ³¨æ„çš„æ˜¯ï¼š</span>
åœ¨ç»“æ„ä½“å­—é¢é‡ä¸­ä¸èƒ½ç®€çŸ­è¡¨ç¤ºåŒ¿åæˆå‘˜çš„è¯­æ³•
```go
var b B = B{Name:"zmg"}  // âŒ âŒ âŒ compile error: unknown fields
// å¦‚æœè¦ä½¿ç”¨å­—é¢é‡çš„æ–¹å¼çš„è¯
var b = B{A: A {Name:"zmg"}, Age:19}  // ç”¨è¿™ç§æ–¹å¼
```

## 4.6 ç»“æ„ä½“æ ‡ç­¾

å¯ä»¥åœ¨ç»“æ„ä½“å­—æ®µåæ·»åŠ æ ‡ç­¾ï¼Œé€šå¸¸ç”¨äºå…ƒæ•°æ®ï¼Œä¾‹å¦‚ JSONã€æ•°æ®åº“å­—æ®µæ˜ å°„ç­‰

```go
type Product struct {
    ID    int    `json:"id"`
    Name  string `json:"product_name"`
    Price float64 `json:"price"`
}
```

## 4.7 structä½œä¸ºæ–¹æ³•çš„æ¥æ”¶è¿™

goå¯ä»¥åœ¨ç»“æ„ä½“ä¸Šå®šä¹‰æ–¹æ³•ï¼Œè¿™ä½¿å¾—ç»“æ„ä½“èƒ½å¤Ÿç”¨äºè¡Œä¸º

```go
// ä½¿ç”¨å€¼æ¥æ”¶è€…ï¼Œä¸ä¼šä¿®æ”¹åŸå§‹ç»“æ„ä½“
func (u User) GetAge() int {
    return u.Age
}

// ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶è€…ï¼Œå¯ä»¥ä¿®æ”¹åŸå§‹ç»“æ„ä½“
func (u *User) SetAge(newAge int) {
    u.Age = newAge
}
```

# 5. JSON

åœ¨æ ‡å‡†åº“ä¸­ï¼Œæœ‰ä¸€ä¸ª`encoding/json` è¿™ä¸ªæ˜¯å¯¹JSONæ“ä½œçš„æ ¸å¿ƒåŒ…

## 5.1 ç¼–ç ï¼ˆEncodingï¼‰ Go Stuct -> JSON

```go
package main

import (
	"encoding/json"
	"fmt"
)

// å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ï¼Œå­—æ®µé¦–å­—æ¯å¿…é¡»å¤§å†™æ‰èƒ½è¢«jsonåŒ…è®¿é—®
type User struct {
	Name string
	Age  int
	// ä½¿ç”¨json tagæ¥å®šä¹‰JSONå­—æ®µåï¼Œå¹¶å¿½ç•¥ç©ºå€¼
	Email string `json:"email,omitempty"`
}

func main() {
	user := User{
		Name:  "Alice",
		Age:   30,
		Email: "alice@example.com",
	}

	// ç¼–ç ä¸º JSON æ ¼å¼çš„å­—èŠ‚åˆ‡ç‰‡
	jsonData, err := json.Marshal(user)
	if err != nil {
		fmt.Println("Error:", err)
		return
	}

	fmt.Println(string(jsonData))
	// è¾“å‡º: {"Name":"Alice","Age":30,"email":"alice@example.com"}
}
```

- åªæœ‰å­—æ®µå¯è§ï¼Œæ‰ä¼šè¢«JSONåŒ…ç¼–ç 

>[!danger]
>å¦‚æœéœ€è¦å¯¹JSONæ ¼å¼formatï¼Œ é‡‡ç”¨`json.MarshalIndent(movies,""," ")`   å‚æ•°å¯ä»¥å‚è€ƒæ–‡æ¡£

## 5.2 è§£ç  ï¼ˆDecodingï¼‰JSON -> Go Struct

```go
package main

import (
	"encoding/json"
	"fmt"
)

type User struct {
	Name string `json:"name"`
	Age  int    `json:"age"`
}

func main() {
	jsonData := []byte(`{"name":"Bob", "age":25}`)

	var user User

	// è§£ç åˆ° user å˜é‡ä¸­
	err := json.Unmarshal(jsonData, &user)  // é‡ç‚¹
	if err != nil {
		fmt.Println("Error:", err)
		return
	}

	fmt.Printf("Name: %s, Age: %d\n", user.Name, user.Age)
	// è¾“å‡º: Name: Bob, Age: 25
}
```


# 6. æ–‡æœ¬å’ŒHTMLæ¨¡æ¿

ç®€å•çš„æ ¼å¼åŒ–ï¼Œç”¨`fmt`ä¸‹çš„`Print`åŸºæœ¬ä¹Ÿå¤Ÿäº†ï¼Œä½†æ˜¯ä¸€äº›å¤æ‚çš„é€»è¾‘ï¼Œå¯ä»¥ä½¿ç”¨`text/template`æˆ–è€…`html/template`ç­‰æ¨¡æ¿åŒ…æ‰å¤„ç†
PS: `html/template`åŒ…å«`text/template`ï¼Œå¹¶ä¸”é¢å¤–æä¾›äº†HTMLå‰ç«¯çš„è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰
## 6.1 é€šç”¨æ–‡æœ¬æ¨¡æ¿
`text/template`ä¸»è¦ç”¨äºç”Ÿæˆä»»ä½•ç±»å‹çš„çº¯æ–‡æœ¬è¾“å‡ºï¼Œæ¯”å¦‚é…ç½®æ–‡ä»¶ã€emailã€æˆ–è€…Javaæ–‡ä»¶ç­‰

ä½¿ç”¨æµç¨‹
- åˆ›å»ºæ¨¡æ¿ ï¼š ä½¿ç”¨`template.New()`åˆ›å»ºä¸€ä¸ªæ¨¡æ¿å®ä¾‹
- è§£ææ¨¡æ¿ï¼šä½¿ç”¨`template.ParseFiles()`æˆ–è€…`template.ParseGlob()`è§£ææ¨¡æ¿æ–‡ä»¶ï¼Œæˆ–è€…ä½¿ç”¨`template.Parse()`è§£æå­—ç¬¦ä¸²
- æ‰§è¡Œæ¨¡æ¿ï¼šä½¿ç”¨`template.Execute()`æ–¹æ³•å°†æ•°æ®åº”ç”¨åˆ°æ¨¡æ¿ä¸Šï¼Œå¹¶å†™å…¥`io.Writer`

```go
package main

import (
	"log"
	"os"
	"text/template"
)

func main() {
	// å®šä¹‰ä¸€ä¸ªæ•°æ®ç»“æ„
	type Config struct {
		Host string
		Port int
	}

	// å‡†å¤‡æ¨¡æ¿å­—ç¬¦ä¸²
	const configTmpl = `
Host: {{.Host}}
Port: {{.Port}}
`

	// åˆ›å»ºä¸€ä¸ªæ¨¡æ¿å®ä¾‹
	tmpl, err := template.New("config").Parse(configTmpl)
	if err != nil {
		log.Fatal(err)
	}

	// å‡†å¤‡æ•°æ®
	data := Config{"localhost", 8080}

	// åˆ›å»ºé…ç½®æ–‡ä»¶
	file, err := os.Create("config.txt")
	if err != nil {
		log.Fatal(err)
	}
	defer file.Close() // ç¡®ä¿æ–‡ä»¶åœ¨å‡½æ•°ç»“æŸæ—¶å…³é—­

	// æ‰§è¡Œæ¨¡æ¿å¹¶å°†ç»“æœå†™å…¥æ–‡ä»¶
	err = tmpl.Execute(file, data)
	if err != nil {
		log.Fatal(err)
	}

	log.Println("é…ç½®æ–‡ä»¶å·²ç”Ÿæˆï¼šconfig.txt")
}
```

## å®‰å…¨HTMLæ¨¡æ¿

`html/template`ä¸“é—¨ä¸ºWebå¼€å‘è®¾è®¡äº†ï¼Œåç»­å¦‚æœç”¨åˆ°äº†ï¼Œå†ç»§ç»­å­¦ä¹ 

```go
package main

import (
	"html/template"
	"log"
	"os"
)

func main() {
	// å‡è®¾ç”¨æˆ·è¾“å…¥äº†æ¶æ„æ•°æ®
	type User struct {
		Name string
	}
	// è¿™é‡Œçš„ Name å­—æ®µåŒ…å«ä¸€ä¸ªè„šæœ¬æ ‡ç­¾
	userData := User{"<script>alert('XSS')</script>"}

	const htmlTmpl = `
<h1>Hello, {{.Name}}!</h1>
`

	tmpl, err := template.New("webpage").Parse(htmlTmpl)
	if err != nil {
		log.Fatal(err)
	}

	// æ‰§è¡Œæ¨¡æ¿
	tmpl.Execute(os.Stdout, userData)
}
```

